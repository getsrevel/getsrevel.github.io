<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.110.0"><meta name=description content><link rel=icon href=/images/favicon.png type=image/png><title>Task Loop using Function Pointers :: Getsrevel</title><link href=/css/nucleus.css?1675174241 rel=stylesheet><link href=/css/fontawesome-all.min.css?1675174241 rel=stylesheet><link href=/css/hybrid.css?1675174241 rel=stylesheet><link href=/css/featherlight.min.css?1675174241 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1675174241 rel=stylesheet><link href=/css/auto-complete.css?1675174241 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1675174241 rel=stylesheet><link href=/css/theme.css?1675174241 rel=stylesheet><link href=/css/tabs.css?1675174241 rel=stylesheet><link href=/css/hugo-theme.css?1675174241 rel=stylesheet><link href=/css/theme-getsrevel.css?1675174241 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1675174241></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style><script async src="https://www.googletagmanager.com/gtag/js?id=UA-158806272-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","UA-158806272-1")</script></head><body data-url=/tech/arduino/task-loop-functions/><nav id=sidebar><div id=header-wrapper><div id=header><a id=logo href=/><svg xmlns="http://www.w3.org/2000/svg" style="background-color:transparent;width:100%;height:100%;fill:#ededed;fill-rule:nonzero" viewBox="0 0 180 50"><text id="_GR_" data-name="{GR}" transform="translate(40 38)" font-size="3em" font-family="Supermercado One"><tspan x="0" y="0">{GR}</tspan></text></svg></a></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1675174241></script>
<script type=text/javascript src=/js/auto-complete.js?1675174241></script>
<script type=text/javascript>var baseurl="https://getsrevel.github.io/"</script><script type=text/javascript src=/js/search.js?1675174241></script></div><div class=highlightable><ul class=topics><li data-nav-id=/project/ title=Project class=dd-item><a href=/project/>Project</a><ul><li data-nav-id=/project/html-basics/ title="HTML Basics" class=dd-item><a href=/project/html-basics/>HTML Basics</a></li><li data-nav-id=/project/string-manipulation/ title="String Manipulation" class=dd-item><a href=/project/string-manipulation/>String Manipulation</a></li><li data-nav-id=/project/array-stats/ title="Array Stats" class=dd-item><a href=/project/array-stats/>Array Stats</a></li><li data-nav-id=/project/mastermind/ title=Mastermind class=dd-item><a href=/project/mastermind/>Mastermind</a></li><li data-nav-id=/project/rock-paper-scissor/ title="Rock Paper Scissor" class=dd-item><a href=/project/rock-paper-scissor/>Rock Paper Scissor</a></li><li data-nav-id=/project/shuffle-n-sort/ title="Shuffle & Sort" class=dd-item><a href=/project/shuffle-n-sort/>Shuffle & Sort</a></li><li data-nav-id=/project/game-of-life/ title="John Conway's: Game of life" class=dd-item><a href=/project/game-of-life/>Game of Life</a></li><li data-nav-id=/project/volapyk-dansk/ title=Volapyk-dansk class=dd-item><a href=/project/volapyk-dansk/>Volapyk-dansk</a></li><li data-nav-id=/project/mobile-game/ title="Mobile Game" class=dd-item><a href=/project/mobile-game/>Mobile Game</a></li><li data-nav-id=/project/code-lock/ title="Code Lock" class=dd-item><a href=/project/code-lock/>Code Lock</a></li><li data-nav-id=/project/server-controlled-leds/ title="Styring af LED via web interface" class=dd-item><a href=/project/server-controlled-leds/>Server Controlled LEDs</a></li><li data-nav-id=/project/weather-station/ title="Weather Station" class=dd-item><a href=/project/weather-station/>Weather Station</a></li><li data-nav-id=/project/asteroid/ title="Asteroids Game" class=dd-item><a href=/project/asteroid/>Asteroids Game</a></li><li data-nav-id=/project/recursion/ title=Rekursion class=dd-item><a href=/project/recursion/>Rekursion</a></li><li data-nav-id=/project/stickman/ title=Stickman class=dd-item><a href=/project/stickman/>Stickman</a></li></ul></li><li data-nav-id=/tech/ title=Tech class="dd-item
parent"><a href=/tech/>Tech</a><ul><li data-nav-id=/tech/html/ title=Html class=dd-item><a href=/tech/html/>Html</a></li><li data-nav-id=/tech/css/ title=Css class=dd-item><a href=/tech/css/>Css</a><ul><li data-nav-id=/tech/css/flexbox-layout/ title="Flexbox Layout" class=dd-item><a href=/tech/css/flexbox-layout/>Flexbox Layout</a></li><li data-nav-id=/tech/css/grid-layout/ title="Grid Layout" class=dd-item><a href=/tech/css/grid-layout/>Grid Layout</a></li></ul></li><li data-nav-id=/tech/unity/ title=Unity class=dd-item><a href=/tech/unity/>Unity</a><ul><li data-nav-id=/tech/unity/unity-basics/ title="Unity Basics" class=dd-item><a href=/tech/unity/unity-basics/>Unity Basics</a></li></ul></li><li data-nav-id=/tech/arduino/ title=Arduino class="dd-item
parent"><a href=/tech/arduino/>Arduino</a><ul><li data-nav-id=/tech/arduino/button-trigger/ title="Button Trigger" class=dd-item><a href=/tech/arduino/button-trigger/>Button Trigger</a></li><li data-nav-id=/tech/arduino/neopixel/ title=Neopixel class=dd-item><a href=/tech/arduino/neopixel/>Neopixel</a></li><li data-nav-id=/tech/arduino/hex-string/ title="Hex String" class=dd-item><a href=/tech/arduino/hex-string/>Hex String</a></li><li data-nav-id=/tech/arduino/json-command-receiver/ title="Json Command Receiver" class=dd-item><a href=/tech/arduino/json-command-receiver/>Json Command Receiver</a></li><li data-nav-id=/tech/arduino/task-loop-functions/ title="Task Loop using Function Pointers" class="dd-item
active"><a href=/tech/arduino/task-loop-functions/>Task Loop</a></li><li data-nav-id=/tech/arduino/json-beacon/ title="Json Beacon" class=dd-item><a href=/tech/arduino/json-beacon/>Json Beacon</a></li></ul></li><li data-nav-id=/tech/c-sharp/ title=C# class=dd-item><a href=/tech/c-sharp/>C#</a><ul><li data-nav-id=/tech/c-sharp/c-sharp-intro/ title="C# Intro" class=dd-item><a href=/tech/c-sharp/c-sharp-intro/>C# Intro</a></li><li data-nav-id=/tech/c-sharp/cli-args/ title="Command Line Interface Arguments" class=dd-item><a href=/tech/c-sharp/cli-args/>CLI Arguments</a></li><li data-nav-id=/tech/c-sharp/temperature-assessment/ title="Temperature Assessment" class=dd-item><a href=/tech/c-sharp/temperature-assessment/>Temperature Assessment</a></li><li data-nav-id=/tech/c-sharp/guessing-game/ title="Guessing Game" class=dd-item><a href=/tech/c-sharp/guessing-game/>Guessing Game</a></li></ul></li><li data-nav-id=/tech/react/ title=React class=dd-item><a href=/tech/react/>React</a><ul><li data-nav-id=/tech/react/react-intro/ title="React Intro" class=dd-item><a href=/tech/react/react-intro/>React Intro</a></li><li data-nav-id=/tech/react/component-props/ title="Components + Data" class=dd-item><a href=/tech/react/component-props/>Components + Data</a></li><li data-nav-id=/tech/react/react-with-firebase/ title="React + Firebase" class=dd-item><a href=/tech/react/react-with-firebase/>React + Firebase</a></li><li data-nav-id=/tech/react/react-fake-weather/ title="React + Firestore Fake Weather" class=dd-item><a href=/tech/react/react-fake-weather/>Fake Weather</a></li></ul></li><li data-nav-id=/tech/chartjs/ title=Chart.js class=dd-item><a href=/tech/chartjs/>Chart.js</a></li><li data-nav-id=/tech/firebase/ title=Firebase class=dd-item><a href=/tech/firebase/>Firebase</a><ul><li data-nav-id=/tech/firebase/firestore-client/ title="Firestore Client" class=dd-item><a href=/tech/firebase/firestore-client/>Firestore Client</a></li><li data-nav-id=/tech/firebase/firestore-upload/ title="Firestore Node Upload" class=dd-item><a href=/tech/firebase/firestore-upload/>Firestore Upload</a></li></ul></li><li data-nav-id=/tech/regex/ title=Regex class=dd-item><a href=/tech/regex/>Regex</a></li><li data-nav-id=/tech/mindstorms/ title=Mindstorms class=dd-item><a href=/tech/mindstorms/>Mindstorms</a></li><li data-nav-id=/tech/hugo/ title="Hugo Static Site Generator" class=dd-item><a href=/tech/hugo/>Hugo</a></li><li data-nav-id=/tech/node/ title=Node.js class=dd-item><a href=/tech/node/>Node.js</a><ul><li data-nav-id=/tech/node/intro/ title=Intro class=dd-item><a href=/tech/node/intro/>Intro</a></li><li data-nav-id=/tech/node/cli-args/ title="Command Line Interface Arguments" class=dd-item><a href=/tech/node/cli-args/>CLI arguments</a></li><li data-nav-id=/tech/node/discord-bot/ title="Discord Bot" class=dd-item><a href=/tech/node/discord-bot/>Discord Bot</a></li><li data-nav-id=/tech/node/web-server/ title="Web Server" class=dd-item><a href=/tech/node/web-server/>Web Server</a></li><li data-nav-id=/tech/node/webrtc-server/ title="Webrtc Server" class=dd-item><a href=/tech/node/webrtc-server/>Webrtc Server</a></li><li data-nav-id=/tech/node/readline-stdin/ title="Readline on Stdin" class=dd-item><a href=/tech/node/readline-stdin/>Readline on Stdin</a></li><li data-nav-id=/tech/node/serial-json/ title="Serial Json" class=dd-item><a href=/tech/node/serial-json/>Serial Json</a></li><li data-nav-id=/tech/node/socket-io-demo/ title="Socket IO" class=dd-item><a href=/tech/node/socket-io-demo/>Socket IO</a></li><li data-nav-id=/tech/node/web-scraping/ title="Web Scraping" class=dd-item><a href=/tech/node/web-scraping/>Web Scraping</a></li></ul></li><li data-nav-id=/tech/p5js/ title=p5.js class=dd-item><a href=/tech/p5js/>p5.js</a><ul><li data-nav-id=/tech/p5js/intro/ title="Intro til P5js" class=dd-item><a href=/tech/p5js/intro/>Intro</a></li><li data-nav-id=/tech/p5js/canvas/ title=Canvas class=dd-item><a href=/tech/p5js/canvas/>Canvas</a></li><li data-nav-id=/tech/p5js/objects-simple/ title="Objects Simple" class=dd-item><a href=/tech/p5js/objects-simple/>Objects Simple</a></li><li data-nav-id=/tech/p5js/circle-rain/ title="Circle Rain" class=dd-item><a href=/tech/p5js/circle-rain/>Circle Rain</a></li><li data-nav-id=/tech/p5js/input-events/ title="Input Events" class=dd-item><a href=/tech/p5js/input-events/>Input Events</a></li><li data-nav-id=/tech/p5js/circle-collision/ title="Circle Collision" class=dd-item><a href=/tech/p5js/circle-collision/>Circle Collision</a></li><li data-nav-id=/tech/p5js/shape-drawing/ title="Shape Drawing" class=dd-item><a href=/tech/p5js/shape-drawing/>Shape Drawing</a></li><li data-nav-id=/tech/p5js/nested-loops/ title="Nested Loops" class=dd-item><a href=/tech/p5js/nested-loops/>Nested Loops</a></li><li data-nav-id=/tech/p5js/ball-objects/ title="Ball Objects" class=dd-item><a href=/tech/p5js/ball-objects/>Ball Objects</a></li><li data-nav-id=/tech/p5js/map-range/ title="Map Range" class=dd-item><a href=/tech/p5js/map-range/>Map Range</a></li><li data-nav-id=/tech/p5js/logical-operators/ title="Logical Operators" class=dd-item><a href=/tech/p5js/logical-operators/>Logical Operators</a></li><li data-nav-id=/tech/p5js/ball-bounce/ title="Ball Bounce" class=dd-item><a href=/tech/p5js/ball-bounce/>Ball Bounce</a></li><li data-nav-id=/tech/p5js/random-color/ title="Random Color" class=dd-item><a href=/tech/p5js/random-color/>Random Color</a></li><li data-nav-id=/tech/p5js/times-table/ title="Times Table" class=dd-item><a href=/tech/p5js/times-table/>Times Table</a></li><li data-nav-id=/tech/p5js/key-pressed-multi/ title="Key Press Multi" class=dd-item><a href=/tech/p5js/key-pressed-multi/>Key Press Multi</a></li><li data-nav-id=/tech/p5js/key-is-pressed/ title=Keyboard class=dd-item><a href=/tech/p5js/key-is-pressed/>Keyboard</a></li><li data-nav-id=/tech/p5js/fullscreen-toggle/ title="Fullscreen toggle" class=dd-item><a href=/tech/p5js/fullscreen-toggle/>Fullscreen toggle</a></li><li data-nav-id=/tech/p5js/key-pressed-simple/ title="Key Pressed Simple" class=dd-item><a href=/tech/p5js/key-pressed-simple/>Key Pressed Simple</a></li><li data-nav-id=/tech/p5js/multitouch/ title=Multitouch class=dd-item><a href=/tech/p5js/multitouch/>Multitouch</a></li><li data-nav-id=/tech/p5js/polar-loop/ title="Polar Loop" class=dd-item><a href=/tech/p5js/polar-loop/>Polar Loop</a></li><li data-nav-id=/tech/p5js/polar-spinner/ title="Polar Spinner" class=dd-item><a href=/tech/p5js/polar-spinner/>Polar Spinner</a></li><li data-nav-id=/tech/p5js/tacospin/ title=Tacospin class=dd-item><a href=/tech/p5js/tacospin/>Tacospin</a></li><li data-nav-id=/tech/p5js/hsl-colors/ title="HSL Colors" class=dd-item><a href=/tech/p5js/hsl-colors/>HSL Colors</a></li><li data-nav-id=/tech/p5js/stickman-demo/ title="Stickman Objects" class=dd-item><a href=/tech/p5js/stickman-demo/>Stickman Objects</a></li><li data-nav-id=/tech/p5js/sound/ title=Sound class=dd-item><a href=/tech/p5js/sound/>Sound</a></li></ul></li></ul></li><li data-nav-id=/tools/ title=Tools class=dd-item><a href=/tools/>Tools</a><ul><li data-nav-id=/tools/command-line/ title="Command Line Basics" class=dd-item><a href=/tools/command-line/>Command Line</a></li><li data-nav-id=/tools/development-model/ title="Iterativ udvikling" class=dd-item><a href=/tools/development-model/>Iterativ udvikling</a></li><li data-nav-id=/tools/code-editor/ title="Code Editors and IDE's" class=dd-item><a href=/tools/code-editor/>Editors and IDE's</a></li><li data-nav-id=/tools/git/ title="Git Intro" class=dd-item><a href=/tools/git/>Git Intro</a></li></ul></li></ul><section id=footer><p>&copy; 2019 - 2023</p><canvas id=qr></canvas>
<script src=https://cdn.jsdelivr.net/npm/qrious@4.0.2/dist/qrious.min.js integrity="sha256-25ncr0CpJhgbzkUiR3wu/Fkk9sSykRG2qX+upHfJUos=" crossorigin=anonymous></script>
<script>(function(){let e=new QRious({element:document.getElementById("qr"),size:200,level:"H",background:"#b3b3b3",value:window.location.href})})()</script></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/>Getsrevel</a> > <a href=/tech/>Tech</a> > <a href=/tech/arduino/>Arduino</a> > Task Loop using Function Pointers</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#materiale>Materiale</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Task Loop using Function Pointers</h1><p>Dette eksempel illustrerer, hvordan man kan bruge function pointers til at køre forskellige opgaver med hvert sit interval, uden at de blokerer for hinanden i længere tid end det tager at eksekvere en enkelt opgave.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-c data-lang=c><span style=display:flex><span><span style=color:#66d9ef>typedef</span> <span style=color:#66d9ef>struct</span> MyTask {
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>void</span> (<span style=color:#f92672>*</span>handler)();
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>int</span> intervalMs;
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>int</span> taskId;
</span></span><span style=display:flex><span>   <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> lastRunMs;
</span></span><span style=display:flex><span>} MyTask;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Forward declaration of the task runner functions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>task_main</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>task_A</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>task_B</span>();
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>task_C</span>();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>MyTask tasks[] <span style=color:#f92672>=</span> {
</span></span><span style=display:flex><span>  {.handler<span style=color:#f92672>=</span>task_main},
</span></span><span style=display:flex><span>  {task_A,<span style=color:#ae81ff>300</span>},
</span></span><span style=display:flex><span>  {task_B,<span style=color:#ae81ff>500</span>},
</span></span><span style=display:flex><span>  {task_C,<span style=color:#ae81ff>3000</span>}
</span></span><span style=display:flex><span>};
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>const</span> <span style=color:#66d9ef>int</span> arrSize <span style=color:#f92672>=</span> <span style=color:#66d9ef>sizeof</span>(tasks)<span style=color:#f92672>/</span><span style=color:#66d9ef>sizeof</span>(MyTask);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>setup</span>() {
</span></span><span style=display:flex><span>  <span style=color:#75715e>// initialize serial communication at 115200 bits per second:
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  Serial.<span style=color:#a6e22e>begin</span>(<span style=color:#ae81ff>115200</span>);
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  Serial.<span style=color:#a6e22e>print</span>(<span style=color:#e6db74>&#34;Task count: &#34;</span>);
</span></span><span style=display:flex><span>  Serial.<span style=color:#a6e22e>println</span>(arrSize);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> ; i<span style=color:#f92672>&lt;</span>arrSize; i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span>(tasks[i].intervalMs <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>0</span>){
</span></span><span style=display:flex><span>      tasks[i].intervalMs <span style=color:#f92672>=</span> (i<span style=color:#f92672>+</span><span style=color:#ae81ff>1</span>)<span style=color:#f92672>*</span><span style=color:#ae81ff>100</span>;
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    String msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;</span>;
</span></span><span style=display:flex><span>    msg <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;task id: &#34;</span>;
</span></span><span style=display:flex><span>    msg <span style=color:#f92672>+=</span> i;
</span></span><span style=display:flex><span>    msg <span style=color:#f92672>+=</span> <span style=color:#e6db74>&#34;, interval &#34;</span>;
</span></span><span style=display:flex><span>    msg <span style=color:#f92672>+=</span> tasks[i].intervalMs;
</span></span><span style=display:flex><span>    Serial.<span style=color:#a6e22e>println</span>(msg);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  
</span></span><span style=display:flex><span>  Serial.<span style=color:#a6e22e>println</span>(<span style=color:#e6db74>&#34;Setup DONE&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// example of non-blocking asyncronous wait loop using function pointers
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>loop</span>() {
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>for</span>(<span style=color:#66d9ef>int</span> i<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span> ; i<span style=color:#f92672>&lt;</span>arrSize; i<span style=color:#f92672>++</span>){
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>runInterval</span>(<span style=color:#f92672>&amp;</span>tasks[i]);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>runInterval</span>(<span style=color:#66d9ef>struct</span> MyTask <span style=color:#f92672>*</span>t){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> tickMs <span style=color:#f92672>=</span> <span style=color:#a6e22e>millis</span>();
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>unsigned</span> <span style=color:#66d9ef>long</span> diffMs <span style=color:#f92672>=</span> tickMs <span style=color:#f92672>-</span> t<span style=color:#f92672>-&gt;</span>lastRunMs;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Handle first run
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span>(<span style=color:#ae81ff>0</span> <span style=color:#f92672>==</span> t<span style=color:#f92672>-&gt;</span>lastRunMs){
</span></span><span style=display:flex><span>    t<span style=color:#f92672>-&gt;</span>lastRunMs <span style=color:#f92672>=</span> tickMs;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>bool</span> shouldRun <span style=color:#f92672>=</span> (t<span style=color:#f92672>-&gt;</span>intervalMs <span style=color:#f92672>&lt;</span> diffMs);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(<span style=color:#f92672>!</span>shouldRun){
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>return</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Store last run
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  t<span style=color:#f92672>-&gt;</span>lastRunMs <span style=color:#f92672>=</span> tickMs;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>// Perform the process by calling the handler function
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>  (t<span style=color:#f92672>-&gt;</span>handler)();
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>// Create some tasks to run in the example
</span></span></span><span style=display:flex><span><span style=color:#75715e></span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>task_main</span>(){
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>static</span> <span style=color:#66d9ef>int</span> runCount <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>;
</span></span><span style=display:flex><span>  Serial.<span style=color:#a6e22e>print</span>(<span style=color:#e6db74>&#34;.&#34;</span>);
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span>(<span style=color:#ae81ff>0</span> <span style=color:#f92672>==</span> runCount <span style=color:#f92672>%</span> <span style=color:#ae81ff>30</span>){
</span></span><span style=display:flex><span>    Serial.<span style=color:#a6e22e>println</span>();
</span></span><span style=display:flex><span>    Serial.<span style=color:#a6e22e>print</span>(runCount);
</span></span><span style=display:flex><span>    Serial.<span style=color:#a6e22e>print</span>(<span style=color:#e6db74>&#34; : &#34;</span>);
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>  runCount<span style=color:#f92672>++</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>task_A</span>(){
</span></span><span style=display:flex><span>  Serial.<span style=color:#a6e22e>print</span>(<span style=color:#e6db74>&#34;A&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>task_B</span>(){
</span></span><span style=display:flex><span>  Serial.<span style=color:#a6e22e>print</span>(<span style=color:#e6db74>&#34;B&#34;</span>);
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>void</span> <span style=color:#a6e22e>task_C</span>(){
</span></span><span style=display:flex><span>  Serial.<span style=color:#a6e22e>print</span>(<span style=color:#e6db74>&#34;C&#34;</span>);
</span></span><span style=display:flex><span>}</span></span></code></pre></div><p>Når eksemplet køres på en arduino generes dette output på seriel porten.</p><p><em>Bemærk</em> at baudrate er sat til 115200.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>Task count: 4
</span></span><span style=display:flex><span>task id: 0, interval 100
</span></span><span style=display:flex><span>task id: 1, interval 300
</span></span><span style=display:flex><span>task id: 2, interval 500
</span></span><span style=display:flex><span>task id: 3, interval 3000
</span></span><span style=display:flex><span>Setup DONE
</span></span><span style=display:flex><span>.
</span></span><span style=display:flex><span>0 : .A..B.A...A.B..A...BA...A..B.A...A.B..A...CBA..
</span></span><span style=display:flex><span>30 : .A..B.A...A.B..A...BA...A..B.A...A.B..A...CBA..
</span></span><span style=display:flex><span>60 : .A..B.A...A.B..A...BA...A..B.A...A.B..A...CBA..
</span></span><span style=display:flex><span>90 : .A..B.A...A.B..A...BA...A..B.A...A.B..A..C.BA..
</span></span><span style=display:flex><span>120 : .A.B..A...AB...A..B.A...A.B..A..A.B..A...CBA...</span></span></code></pre></div><h2 id=materiale>Materiale</h2><ul><li><a href=http://www.cplusplus.com/forum/beginner/15967/>How to use typedef struct tagName</a></li><li><a href=https://gcc.gnu.org/onlinedocs/gcc-4.1.2/gcc/Designated-Inits.html>Designated initializers</a></li></ul><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/tech/arduino/json-command-receiver/ title="Json Command Receiver"><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/tech/arduino/json-beacon/ title="Json Beacon" style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1675174241></script>
<script src=/js/perfect-scrollbar.min.js?1675174241></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1675174241></script>
<script src=/js/jquery.sticky.js?1675174241></script>
<script src=/js/featherlight.min.js?1675174241></script>
<script src=/js/highlight.pack.js?1675174241></script>
<script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1675174241></script>
<script src=/js/learn.js?1675174241></script>
<script src=/js/hugo-learn.js?1675174241></script>
<script src=/mermaid/mermaid.js?1675174241></script>
<script>mermaid.initialize({startOnLoad:!0})</script></body></html>